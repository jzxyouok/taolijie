<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.fh.taolijie.dao.mapper.ApplicationIntendModelMapper">
    <resultMap id="BaseResultMap" type="com.fh.taolijie.domain.resume.ApplicationIntendModel">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <result column="am_resume_id" property="resumeId" jdbcType="INTEGER"/>
        <result column="am_job_post_category_id" property="jobPostCategoryId" jdbcType="INTEGER"/>

        <association property="resume" resultMap="com.fh.taolijie.dao.mapper.ResumeModelMapper.BaseResultMap" />
        <association property="category" resultMap="com.fh.taolijie.dao.mapper.JobPostCategoryModelMapper.BaseResultMap" />

    </resultMap>

    <sql id="resume_column">
        re.id AS resume_id, re.name AS resume_name, re.gender AS resume_gender, re.age AS resume_age,
        re.height AS resume_height, re.photo_path AS resume_photo_path, re.email AS resume_email,
        re.qq AS resume_qq, re.member_id AS resume_member_id, re.access_authority AS resume_access_authority,
        re.page_view AS resume_page_view, re.verified AS resume_verified, re.photo_id AS resume_photo_id,
        re.phone_number AS resume_phone_number, re.wechat_account AS resume_wechat_account, re.created_time AS resume_created_time,
        re.experience AS resume_experience, re.introduce AS resume_introduce

    </sql>

    <sql id="job_post_column">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        post.id AS job_id, post.title AS job_title, post.expired_time  AS job_expired_time, post.post_time AS job_post_time, post.work_place AS job_work_place, post.wage AS job_wage, post.time_to_pay AS job_time_to_pay,
        post.job_description AS job_job_description,
        post.contact AS job_contact, post.contact_phone AS job_contact_phone, post.contact_email AS job_contact_email, post.contact_qq AS job_contact_qq, post.job_detail AS job_job_detail, post.likes AS job_likes,
        post.dislikes AS job_dislikes, post.job_post_category_id AS job_job_post_category_id,
        post.member_id AS job_member_id, post.education_level AS job_education_level, post.complaint AS job_complaint, post.work_time AS job_work_time, post.salary_unit AS job_salary_unit, post.page_view AS job_page_view,
        post.verified AS job_verified,
        post.job_postcol AS job_job_postcol, post.applicant_amount AS job_applicant_amount, post.introduce AS job_introduce, post.application_resume_ids AS job_application_resume_ids
    </sql>

    <sql id="category_column">
        cate.id AS job_cate_id, cate.name AS job_cate_name, cate.level AS job_cate_level, cate.theme_color AS job_cate_theme_color, cate.memo AS
        job_cate_memo
    </sql>

    <insert id="insert" parameterType="com.fh.taolijie.domain.resume.ApplicationIntendModel">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        INSERT INTO resume_job_post_category (resume_id, job_post_category_id)
        VALUES (#{resumeId,jdbcType=INTEGER}, #{jobPostCategoryId,jdbcType=INTEGER})
    </insert>
    <insert id="insertSelective" parameterType="com.fh.taolijie.domain.resume.ApplicationIntendModel">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into resume_job_post_category
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="resumeId != null">
                resume_id,
            </if>
            <if test="jobPostCategoryId != null">
                job_post_category_id,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="resumeId != null">
                #{resumeId,jdbcType=INTEGER},
            </if>
            <if test="jobPostCategoryId != null">
                #{jobPostCategoryId,jdbcType=INTEGER},
            </if>
        </trim>
    </insert>

    <delete id="delete">
        DELETE FROM resume_job_post_category
        WHERE resume_id = #{resumeId} AND job_post_category_id = #{jobPostCategoryId}
    </delete>

    <delete id="deleteByResumeId">
        DELETE FROM
            resume_job_post_category
        WHERE
            resume_id = #{resumeId}
    </delete>

    <select id="getByIntend" resultMap="BaseResultMap">
        SELECT
            am.resume_id AS am_resume_id,
            am.job_post_category_id AS am_job_post_category_id,
            <include refid="resume_column" />,
            <include refid="category_column" />
        FROM
            resume_job_post_category am
        INNER JOIN
            resume re ON re.id = am.resume_id
        INNER JOIN
            job_post_category cate ON cate.id = am.job_post_category_id
        WHERE
            am.job_post_category_id = #{categoryId}
        LIMIT
            #{pageNumber}, #{pageSize}
    </select>

    <select id="getByResume" resultMap="BaseResultMap">
        SELECT
            intend.resume_id AS am_resume_id,
            intend.job_post_category_id AS am_job_post_category_id,
            <include refid="category_column" />
        FROM resume_job_post_category intend
            INNER JOIN job_post_category cate ON cate.id = intend.job_post_category_id
        WHERE intend.resume_id = #{resumeId}
    </select>

    <select id="getByResumeInBatch" resultMap="BaseResultMap">
        SELECT
            intend.resume_id AS am_resume_id,
            intend.job_post_category_id AS am_job_post_category_id,
            <include refid="category_column" />
        FROM
            resume_job_post_category intend
        INNER JOIN
            job_post_category cate ON cate.id = intend.job_post_category_id
        WHERE
            intend.resume_id IN <foreach collection="list" item="id" open="(" close=")" separator=",">#{id}</foreach>

    </select>
</mapper>